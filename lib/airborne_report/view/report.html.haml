!!! 5
%html
  %head
    %title= Time.now
    %meta{charset: "utf-8"}
  %body
    %div
      %b
        all:
        = @statuses["all"]
      %b{class: "passed"}
        passed:
        = @statuses["passed"]
      %b{class: "failed"}
        failed:
        = @statuses["failed"]
      %b{class: "pending"}
        pending:
        = @statuses["pending"]
    - @tests.each do |example|
      %details
        %summary{class: "collapse #{example.last['status']}"}
          = example.last['full_description']
        %div
          %div{class: 'section'}
          - if example.last['response'] && example.last['response']['request'] && example.last['response']['body']
            %div
              %b path:
              = example.first
            %div
              %b time:
              = example.last['time']
            %div{class: 'section'}
              %div
                %b request.method:
                = example.last['response']['request']['method']
              %div
                %b request.url:
                = example.last['response']['request']['url']
              %div
                %b request.headers:
                = example.last['response']['request']['headers']
              %div
                %b request.body:
                %xmp
                  = example.last['response']['request']['body']
            %div{class: 'section'}
              %div
                %b response.headers:
                = example.last['response']['headers']
              %div
                %b response.body:
                %xmp
                  = example.last['response']['body']
          - elsif example.last['response'] && example.last['response']['request']
            %div
              %b path:
              = example.first
            %div{class: 'section'}
              %div
                %b request.method:
                = example.last['response']['request']['method']
              %div
                %b request.url:
                = example.last['response']['request']['url']
              %div
                %b request.headers:
                = example.last['response']['request']['headers']
              %div
                %b request.body:
                = example.last['response']['request']['body']
            %div{class: 'section'}
              %div
                Request failed
          - elsif example.last['status'] == 'pending'
            %div
              %b path:
              = example.first
          - else
            %div
              %b path:
              = example.first
            Test failed
            %div
              %b exception.class:
              = example.last['exception']['class']
            %div
              %b exception.message:
              = example.last['exception']['message']
            %div
              %b exception.backtrace:
              = example.last['exception']['backtrace']
